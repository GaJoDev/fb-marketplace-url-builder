<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Facebook Marketplace URL Builder â€” Tiny</title>
  <style>
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;margin:24px;background:#f7f7f8}
    .card{background:#fff;padding:24px 18px 18px 18px;border-radius:10px;box-shadow:0 6px 18px rgba(18,18,18,0.06);max-width:640px}
    label{display:block;font-size:13px;margin-top:16px;color:#333}
    input[type=text], input[type=number], select{width:100%;padding:12px 10px;border-radius:6px;border:1px solid #ddd;font-size:14px;margin-top:4px;box-sizing:border-box}
    .row{display:flex;gap:12px;margin-top:12px}
    .row > *{flex:1}
    .actions{margin-top:18px;display:flex;gap:8px}
    button{padding:10px 12px;border-radius:8px;border:0;background:#1877f2;color:#fff;font-weight:600;cursor:pointer}
    button.secondary{background:#556;opacity:0.95}
    pre{background:#f2f4f7;padding:10px;border-radius:8px;overflow:auto;margin-top:8px}
    small{color:#666}
    .checkbox-group label{display:flex;align-items:center;gap:6px;margin-top:4px;font-weight:normal}
  </style>
</head>
<body>
  <div class="card">
    <h3>Facebook Marketplace URL builder (with locations, radius & condition)</h3>

    <label>Choose Marketplace area</label>
    <select id="marketplaceId">
      <option value="108700782494847">Bristol</option>
      <option value="123456789012345">Bath</option>
      <option value="234567890123456">Weston-super-Mare</option>
      <option value="108132799207869">Keynsham</option>
    </select>

    <label>Search radius (km)</label>
    <select id="radius">
      <option value="5">5 km</option>
      <option value="10" selected>10 km</option>
      <option value="15">15 km</option>
      <option value="20">20 km</option>
      <option value="25">25 km</option>
      <option value="30">30 km</option>
    </select>

    <label>Search query <small style="display:block;color:#666;">Tip: use commas for multiple keywords to perform fuzzy search, e.g., bike, wheels, frame</small></label>
    <input id="query" type="text" value="" />

    <div class="row">
      <div>
        <label>Min price</label>
        <input id="minPrice" type="number" value="0" min="0" />
      </div>
      <div>
        <label>Max price</label>
        <input id="maxPrice" type="number" value="80" min="0" />
      </div>
    </div>

    <div class="row">
      <div>
        <label>Days since listed</label>
        <input id="days" type="number" value="18" min="0" />
      </div>
    </div>

    <label>Item condition</label>
    <div class="checkbox-group">
      <label><input type="checkbox" value="new" checked class="condition-checkbox"> New</label>
      <label><input type="checkbox" value="used_like_new" checked class="condition-checkbox"> Used - Like New</label>
      <label><input type="checkbox" value="used_good" checked class="condition-checkbox"> Used - Good</label>
      <label><input type="checkbox" value="used_fair" checked class="condition-checkbox"> Used - Fair</label>
    </div>

    <label style="margin-top:16px"><input id="exact" type="checkbox" /> Exact match</label>
    <label style="margin-top:16px"><input id="freeOnly" type="checkbox" /> Free items only</label>

    <div class="actions">
      <button id="build">Build URL</button>
      <button id="open" class="secondary" title="Opens the built url in a new tab">Open in new tab</button>
      <button id="copy" class="secondary">Copy URL</button>
    </div>

    <label>Resulting URL</label>
    <pre id="result"></pre>

    <p><small>Tip: select your area, radius, condition, then paste the link into Facebook to open the Marketplace search.</small></p>
  </div>

  <script>
    const marketplaceId = document.getElementById('marketplaceId');
    const radius = document.getElementById('radius');
    const query = document.getElementById('query');
    const minPrice = document.getElementById('minPrice');
    const maxPrice = document.getElementById('maxPrice');
    const days = document.getElementById('days');
    const exact = document.getElementById('exact');
    const freeOnly = document.getElementById('freeOnly');
    const conditionCheckboxes = document.querySelectorAll('.condition-checkbox');
    const result = document.getElementById('result');
    const buildBtn = document.getElementById('build');
    const copyBtn = document.getElementById('copy');
    const openBtn = document.getElementById('open');

    function buildUrl(){
      if(freeOnly.checked){
        return 'https://www.facebook.com/marketplace/category/free';
      }

      const base = 'https://www.facebook.com/marketplace/';
      const path = encodeURIComponent((marketplaceId.value || '').trim()) + '/search';
      const params = new URLSearchParams();
      const q = (query.value || '').trim();
      if(minPrice.value) params.set('minPrice', String(minPrice.value));
      if(maxPrice.value) params.set('maxPrice', String(maxPrice.value));
      if(days.value) params.set('daysSinceListed', String(days.value));
      if(q) params.set('query', q);
      if(radius.value) params.set('radius', radius.value);
      const selectedConditions = Array.from(conditionCheckboxes)
                                      .filter(cb => cb.checked)
                                      .map(cb => cb.value);
      if(selectedConditions.length) params.set('itemCondition', selectedConditions.join(','));
      params.set('exact', exact.checked ? 'true' : 'false');
      return base + path + (params.toString() ? '?' + params.toString() : '');
    }

    function updateResult(){
      result.textContent = buildUrl();
    }

    buildBtn.addEventListener('click', (e)=>{ e.preventDefault(); updateResult(); });
    copyBtn.addEventListener('click', async (e)=>{
      e.preventDefault();
      const txt = buildUrl();
      try{
        await navigator.clipboard.writeText(txt);
        copyBtn.textContent = 'Copied!';
        setTimeout(()=> copyBtn.textContent = 'Copy URL', 1200);
      }catch(err){
        window.prompt('Copy this URL', txt);
      }
    });
    openBtn.addEventListener('click', (e)=>{
      e.preventDefault();
      window.open(buildUrl(), '_blank');
    });

    [marketplaceId, radius, query, minPrice, maxPrice, days, exact, freeOnly, ...conditionCheckboxes].forEach(el => el.addEventListener('input', updateResult));

    updateResult();
  </script>
</body>
</html>
